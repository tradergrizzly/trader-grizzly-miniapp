<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Trader Grizzly Bot AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      margin: 0;
      background: #0f0f0f;
      color: #ffffff;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    .screen {
      display: none;
      padding: 40px 20px;
    }
    .active {
      display: block;
    }
    button, select {
      width: 90%;
      padding: 12px;
      margin-top: 20px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
    }
    button {
      background: #3399ff;
      color: #fff;
      cursor: pointer;
    }
    pre {
      text-align: left;
      white-space: pre-wrap;
      margin-top: 20px;
      font-size: 15px;
    }
  </style>
</head>

<body>

<!-- ===== –≠–ö–†–ê–ù 1: –í–´–ë–û–† –ü–ê–†–´ ===== -->
<div id="screen-select" class="screen active">
  <h2>üìä –í—ã–±–æ—Ä –ø–∞—Ä—ã</h2>

  <select id="pair">
    <option value="EUR/USD">EUR/USD</option>
    <option value="GBP/USD">GBP/USD</option>
    <option value="USD/JPY">USD/JPY</option>
  </select>

  <select id="timeframe">
    <option value="1">1 –º–∏–Ω—É—Ç–∞</option>
    <option value="2">2 –º–∏–Ω—É—Ç—ã</option>
    <option value="3">3 –º–∏–Ω—É—Ç—ã</option>
    <option value="5">5 –º–∏–Ω—É—Ç</option>
    <option value="10">10 –º–∏–Ω—É—Ç</option>
  </select>

  <button onclick="requestSignal()">–ü–æ–ª—É—á–∏—Ç—å —Å–∏–≥–Ω–∞–ª</button>
</div>

<!-- ===== –≠–ö–†–ê–ù 2: –ê–ù–ê–õ–ò–ó ===== -->
<div id="screen-loading" class="screen">
  <h2>‚è≥ –ò–¥—ë—Ç –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞</h2>
  <p>–°–∏–≥–Ω–∞–ª –≤ —Ç–µ—á–µ–Ω–∏–µ 10‚Äì20 —Å–µ–∫—É–Ω–¥‚Ä¶</p>
</div>

<!-- ===== –≠–ö–†–ê–ù 3: –°–ò–ì–ù–ê–õ ===== -->
<div id="screen-signal" class="screen">
  <h2>üìä –¢–û–†–ì–û–í–´–ô –°–ò–ì–ù–ê–õ</h2>
  <pre id="signal-text"></pre>
  <p>‚è≥ –î–æ–∂–¥–∏—Ç–µ—Å—å –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞</p>
</div>

<!-- ===== –≠–ö–†–ê–ù 4: –†–ï–ó–£–õ–¨–¢–ê–¢ ===== -->
<div id="screen-result" class="screen">
  <h2>üìà –†–ï–ó–£–õ–¨–¢–ê–¢ –°–î–ï–õ–ö–ò</h2>
  <pre id="result-text"></pre>
  <button onclick="restart()">–°–ª–µ–¥—É—é—â–∏–π —Å–∏–≥–Ω–∞–ª</button>
</div>

<script>
/* === –¢–í–û–ô NGROK –£–ñ–ï –í–°–¢–ê–í–õ–ï–ù === */
const API_URL = "https://scleroid-measureless-kaya.ngrok-free.dev";

let signalData = null;

// === –ó–ê–ü–†–û–° –°–ò–ì–ù–ê–õ–ê ===
async function requestSignal() {
  const pair = document.getElementById("pair").value;
  const timeframe = Number(document.getElementById("timeframe").value);

  switchScreen("screen-loading");

  const response = await fetch(API_URL + "/signal", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ pair, timeframe })
  });

  signalData = await response.json();

  // –∏–º–∏—Ç–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ 10‚Äì20 —Å–µ–∫
  setTimeout(showSignal, 12000);
}

// === –ü–û–ö–ê–ó –°–ò–ì–ù–ê–õ–ê ===
function showSignal() {
  const s = signalData.signal;

  document.getElementById("signal-text").textContent =
`üí± –ü–∞—Ä–∞: ${s.pair}
üìà –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ${s.direction}
‚è±Ô∏è –¢–∞–π–º—Ñ—Ä–µ–π–º: ${s.timeframe} –º–∏–Ω
‚≠ê –ö–∞—á–µ—Å—Ç–≤–æ: ${s.quality}
üí∞ –¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è: ${s.open_price}
üïí –í—Ä–µ–º—è –≤—Ö–æ–¥–∞: ${s.entry_time}`;

  switchScreen("screen-signal");

  setTimeout(showResult, s.timeframe * 60000);
}

// === –ü–û–ö–ê–ó –†–ï–ó–£–õ–¨–¢–ê–¢–ê ===
function showResult() {
  const r = signalData.result;

  document.getElementById("result-text").textContent =
`üí± –ü–∞—Ä–∞: ${r.pair}
üìà –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ${r.direction}
‚≠ê –ö–∞—á–µ—Å—Ç–≤–æ: ${r.quality}
üïí –í—Ä–µ–º—è –≤—Ö–æ–¥–∞: ${r.entry_time}
üïí –í—Ä–µ–º—è –≤—ã—Ö–æ–¥–∞: ${r.exit_time}
üí∞ –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è: ${r.close_price}
üìä –†–∞–∑–Ω–∏—Ü–∞: ${r.difference}

üèÅ –ò—Å—Ö–æ–¥: ${r.outcome === "–ü–õ–Æ–°" ? "‚úÖ –ü–õ–Æ–°" : "‚ùå –ú–ò–ù–£–°"}`;

  switchScreen("screen-result");
}

// === –£–¢–ò–õ–ò–¢–´ ===
function switchScreen(id) {
  document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function restart() {
  switchScreen("screen-select");
}
</script>

</body>
</html>
